(function(e){function t(t){for(var r,o,i=t[0],c=t[1],u=t[2],l=0,f=[];l<i.length;l++)o=i[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);h&&h(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==a[i]&&(r=!1)}r&&(s.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},a={app:0},s=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-aae574c0":"207dfe72"}[e]+".js"}function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-aae574c0":1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise((function(t,n){for(var r="css/"+({}[e]||e)+"."+{"chunk-aae574c0":"3ea69b4f"}[e]+".css",a=c.p+r,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var u=s[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){u=f[i],l=u.getAttribute("data-href");if(l===r||l===a)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var r=t&&t.target&&t.target.src||a,s=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=r,delete o[e],h.parentNode.removeChild(h),n(s)},h.href=a;var b=document.getElementsByTagName("head")[0];b.appendChild(h)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var s=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=s);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(e);var f=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(h);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",f.name="ChunkLoadError",f.type=r,f.request=o,n[1](f)}a[e]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var h=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1:function(e,t){},"42cd":function(e,t,n){"use strict";n("95b0")},"95b0":function(e,t,n){},a23e:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(e,t,n,o,a,s){var i=Object(r["M"])("router-view");return Object(r["D"])(),Object(r["i"])(i)}var a=Object(r["n"])({});a.render=o;var s=a,i=Object(r["h"])(s),c=i,u=(n("d3b7"),n("3ca3"),n("ddb0"),n("6c02")),l=Object(r["fb"])("data-v-2b9fe472");Object(r["G"])("data-v-2b9fe472");var f={class:"sider-container"};Object(r["E"])();var h=l((function(e,t,n,o,a,s){var i=Object(r["M"])("el-option"),c=Object(r["M"])("el-select"),u=Object(r["M"])("KLineWidget"),h=Object(r["M"])("el-main");return Object(r["D"])(),Object(r["i"])("div",null,[e.symbol?(Object(r["D"])(),Object(r["i"])(h,{key:0},{default:l((function(){return[Object(r["m"])("div",f,[Object(r["m"])(c,{modelValue:e.symbol,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.symbol=t}),filterable:"",onChange:e.changeHallder},{default:l((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(e.symbolList.value,(function(e){return Object(r["D"])(),Object(r["i"])(i,{key:e.symbol,label:e.pair,value:e.symbol},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]),Object(r["m"])(u,{symbolInfo:e.symbolInfo,symbol:e.symbol.toLocaleUpperCase(),ref:"kLineRef"},null,8,["symbolInfo","symbol"])]})),_:1})):Object(r["j"])("",!0)])})),b=n("1da1"),d=(n("96cf"),{class:"kline"}),v=Object(r["m"])("div",{id:"tv_chart_container",style:{position:"fixed",top:"0",bottom:"0",left:"0",width:"85%"}},null,-1);function p(e,t,n,o,a,s){return Object(r["D"])(),Object(r["i"])("div",d,[v])}var m=n("3835"),g=n("9824"),y=n("5530"),O=(n("d81d"),n("b0c0"),n("159b"),n("4328")),w=n.n(O),j=n("bc3a"),k=n.n(j),S=k.a.create({baseURL:"http://119.29.175.114:5000",timeout:2e4,validateStatus:function(e){return e>=200&&e<500}}),_=S,x=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_.get("/stockList");case 2:return t=e.sent,n=t.data,console.log(n),r=[],o=n.map((function(e){return{symbol:e.code,name:e.name}})),o.forEach((function(e){r.push(Object(y["a"])(Object(y["a"])({},e),{},{pair:e["symbol"].toLocaleUpperCase()+" "+e["name"].toLocaleUpperCase()}))})),a=r.length?r[0].symbol:"",e.abrupt("return",{list:r,data:a});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var n,r,o,a,s,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t),n=t.symbol,r=t.period,o=t.size,a=w.a.stringify({symbol:n,period:r,size:o}),e.prev=3,e.next=6,_.get("/get_stock?".concat(a));case 6:if(s=e.sent,i=s.data,i&&!i.error){e.next=10;break}return e.abrupt("return",[null]);case 10:return c=i.map((function(e){var t=new Date(e.time).getTime();return{time:t,open:e.open,high:e.high,low:e.low,close:e.close,volume:e.volume}})).sort((function(e,t){return e.time>t.time?1:-1})),console.log(c),e.abrupt("return",[c]);case 15:return e.prev=15,e.t0=e["catch"](3),console.log(e.t0),e.abrupt("return",[null]);case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),L={"1min":"1","60min":"60","1day":"D","1week":"W","1mon":"M"},W=["1","60","D","W","M"],C=n("d4ec"),I=n("bee2"),R=n("acff"),M=n("5a0c"),A=n.n(M),P=n("faa1"),E=n.n(P),N=function(){function e(){Object(C["a"])(this,e),this.url="wss://api.huobi.pro/ws",this.ws=null,this.success={},this.failure={},this.evt=new E.a}return Object(I["a"])(e,[{key:"initWebSocket",value:function(){this.ws=new WebSocket(this.url),this.ws.binaryType="arraybuffer",this.ws.onopen=this.onopen.bind(this),this.ws.onclose=this.onclose.bind(this),this.ws.onerror=this.onerror.bind(this),this.ws.onmessage=this.onmessage.bind(this),console.log(" >> WebSocket init :",this.url)}},{key:"onopen",value:function(){if(this.ws){if(console.log(" >> WebSocket open..."),this.timer)for(var e in clearInterval(this.timer),this.timer=null,this.success)this.ws.send(this.success[e]),console.log(" >> WebSocket send: ".concat(this.success[e]));for(var t in this.failure)this.success[t]||(this.ws.send(this.failure[t]),this.success[t]=this.failure[t],console.log(" >> WebSocket send: ".concat(this.failure[t])));this.failure={}}}},{key:"onclose",value:function(){this.ws=null,console.log(" >> Websocket Close..."),this.timer||this.onReconnection()}},{key:"onerror",value:function(e){console.log(" >> Websocket Error...",e)}},{key:"onmessage",value:function(e){if(e.data){var t,n=R["a"].inflate(e.data,{to:"string"}),r=JSON.parse(n);if(r&&r.ping)null===(t=this.ws)||void 0===t||t.send(JSON.stringify({pong:Date.now()}));else this.onBroadcast(r)}}},{key:"onBroadcast",value:function(e){this.success[e.ch]&&this.evt.emit(e.ch,e)}},{key:"subscribe",value:function(e,t,n){var r,o=this;return r=this.ws&&this.ws.readyState===WebSocket.OPEN?this.successPush(e,t,n):this.failurePush(e,t,n),{remove:function(){o.unsubscribe(e),r.removeAllListeners(e)}}}},{key:"unsubscribe",value:function(e){if(this.failure[e]&&delete this.failure[e],this.success[e])if(this.ws){var t=JSON.parse(this.success[e]);t.cmd="unsub",this.ws.send(JSON.stringify(t)),this.evt.removeAllListeners(e),console.log(" >> WebSocket send: ".concat(JSON.stringify(t))),delete this.success[e]}else delete this.success[e]}},{key:"successPush",value:function(e,t,n){var r;return this.success[e]=JSON.stringify(t),null===(r=this.ws)||void 0===r||r.send(this.success[e]),console.log(" >> WebSocket send: ".concat(this.success[e])),this.evt.on(e,n)}},{key:"failurePush",value:function(e,t,n){return this.failure[e]=JSON.stringify(t),console.log(" >> WebSocket 準備訂閱: ".concat(this.failure[e])),this.evt.on(e,n)}},{key:"onReconnection",value:function(){var e=this;this.url&&(this.initWebSocket(),this.timer=setInterval((function(){e.initWebSocket();var t=A()().format("YYYY-MM-DD HH:mm:ss");console.log(" >> [".concat(t,"] WebSocket Reconnect...."))}),3e3))}}]),e}(),T=(new N,{name:"KLineWidget",props:{symbolInfo:{type:Object,required:!0},symbol:{type:String}},setup:function(e){var t=Object(r["I"])(null),n=Object(r["I"])("60min"),o=Object(r["T"])(e),a=o.symbol,s=o.symbolInfo,i=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(t){var r,o,s,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("params: ",t),r=window.innerWidth,t.firstDataRequest){e.next=5;break}return e.abrupt("return",{bars:[],meta:{noData:!0}});case 5:if(t.resolution!==L[n.value])for(o in L)L[o]===t.resolution&&(n.value=o);return e.next=8,D({symbol:a.value.toLocaleLowerCase(),period:n.value,size:r>2e3?2e3:r});case 8:if(s=e.sent,i=Object(m["a"])(s,1),c=i[0],t.resolution===L[n.value]&&t.firstDataRequest,c){e.next=14;break}return e.abrupt("return",{bars:[],meta:{noData:!0}});case 14:return e.abrupt("return",{bars:c,meta:{noData:!c.length}});case 17:e.prev=17,e.t0=e["catch"](0),console.log("getBars error:",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}(),c=function(){return new Promise((function(e){e({name:a.value,full_name:a.value,description:a.value,type:"stock",session:"24x7",exchange:"Chen",listed_exchange:a.value,timezone:"Asia/Shanghai",format:"price",pricescale:Math.pow(10,s.value["price-precision"]),minmov:1,volume_precision:s.value["value-precision"],has_intraday:!0,supported_resolutions:W})}))},u=Object(r["I"])(new g["DataFeed"]({getBars:function(e){return i(e)},fetchResolveSymbol:function(){return c()},fetchConfiguration:function(){return new Promise((function(e){e({supported_resolutions:W})}))}})),l=function(){var e=new g["widget"]({fullscreen:!0,symbol:a.value,interval:L[n.value],container_id:"tv_chart_container",datafeed:u.value,library_path:"/charting_library/",locale:"zh",theme:"light",timezone:"Asia/Shanghai"});e.onChartReady((function(){e.chart().createStudy("MACD"),e.chart().createStudy("Stochastic RSI"),e.chart().createStudy("Average Directional Index"),e.chart().createStudy("Moving Average",!1,!1,5),e.chart().createStudy("Moving Average",!1,!1,10),e.chart().createStudy("Moving Average",!1,!1,20),t.value=e}))},f=function(e){a.value=e,t.value.setSymbol(e.toLocaleUpperCase(),L[n.value],(function(){console.log("------setSymbol---------",a.value)}))};return Object(r["A"])((function(){l()})),console.log(),{widget:t,setSymbol:f}}});T.render=p;var J=T,H=Object(r["n"])({name:"Home",components:{KLineWidget:J},setup:function(){var e=Object(r["H"])({value:[]}),t=Object(r["I"])(""),n=Object(r["I"])(null),o=Object(r["I"])(null);Object(r["A"])(Object(b["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,x();case 2:o=r.sent,e.value=o.list,t.value=o.data,n.value=o.list[0],n.value,console.log("symbolInfo",n);case 8:case"end":return r.stop()}}),r)}))));var a=function(e){console.log("eeeeeee",e),t.value=e,o.value.setSymbol(e)};return{symbol:t,symbolList:e,symbolInfo:n,changeHallder:a,kLineRef:o}}});n("42cd");H.render=h,H.__scopeId="data-v-2b9fe472";var B=H,U=[{path:"/",name:"Home",component:B},{path:"/about",name:"about",component:function(){return n.e("chunk-aae574c0").then(n.bind(null,"ef46"))}}],z=Object(u["a"])({history:Object(u["b"])(),routes:U}),q=z;c.use(q);var K=n("5502"),Y=Object(K["a"])({state:{},mutations:{},actions:{},modules:{}});c.use(Y);var V=n("3fd4");n("7dd6");c.use(V["a"]);var F=n("313e"),G=n("fdf1");c.use(G["a"],{echarts:F,h:r["p"]});n("a23e");c.mount("#app")}});